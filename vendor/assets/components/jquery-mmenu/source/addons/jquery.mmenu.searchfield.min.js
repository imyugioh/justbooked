/*	
 * jQuery mmenu searchfield addon
 * @requires mmenu 4.0.0 or later
 *
 * mmenu.frebsite.nl
 *	
 * Copyright (c) Fred Heusschen
 * www.frebsite.nl
 *
 * Dual licensed under the MIT and GPL licenses.
 * http://en.wikipedia.org/wiki/MIT_License
 * http://en.wikipedia.org/wiki/GNU_General_Public_License
 */


!function(a){function d(a){switch(a){case 9:case 16:case 17:case 18:case 37:case 38:case 39:case 40:return!0}return!1}var b="mmenu",c="searchfield";a[b].prototype["_addon_"+c]=function(){var e=this,f=this.opts[c],g=a[b]._c,h=a[b]._d,i=a[b]._e;if(g.add("search hassearch noresults nosubresults counter"),i.add("search reset keyup change update"),"boolean"==typeof f&&(f={add:f,search:f}),"object"!=typeof f&&(f={}),f=a.extend(!0,{},a[b].defaults[c],f),f.add&&(a('<div class="'+g.search+'" />').prependTo(this.$menu).append('<input placeholder="'+f.placeholder+'" type="text" autocomplete="off" />'),f.noResults&&a("ul",this.$menu).first().append('<li class="'+g.noresults+'">'+f.noResults+"</li>")),a("div."+g.search,this.$menu).length&&this.$menu.addClass(g.hassearch),f.search){var j=a("div."+g.search,this.$menu).find("input");if(j.length){var k=a("ul."+g.list+"> li."+g.label,this.$menu),l=a("ul."+g.list+"> li",this.$menu).not("."+g.subtitle).not("."+g.label).not("."+g.noresults),m="> a";f.showLinksOnly||(m+=", > span"),j.on(i.keyup,function(a){d(a.keyCode)||e.$menu.trigger(i.search)}).on(i.change,function(){e.$menu.trigger(i.search)}),this.$menu.on(i.reset+" "+i.search,function(a){a.stopPropagation()}).on(i.reset,function(){e.$menu.trigger(i.search,[""])}).on(i.search,function(b,c){"string"==typeof c?j.val(c):c=j.val(),c=c.toLowerCase(),l.add(k).addClass(g.hidden),l.each(function(){var b=a(this);a(m,b).text().toLowerCase().indexOf(c)>-1&&b.add(b.prevAll("."+g.label).first()).removeClass(g.hidden)}),a(a("."+g.panel,e.$menu).get().reverse()).each(function(){var b=a(this),c=b.data(h.parent);if(c){var d=b.add(b.find("> ."+g.list)).find("> li").not("."+g.subtitle).not("."+g.label).not("."+g.hidden);d.length?c.removeClass(g.hidden).removeClass(g.nosubresults).prevAll("."+g.label).first().removeClass(g.hidden):(b.hasClass(g.current)&&c.trigger(i.open),c.addClass(g.nosubresults))}}),e.$menu[l.not("."+g.hidden).length?"removeClass":"addClass"](g.noresults),a("em."+g.counter,e.$menu).trigger(i.update)})}}},a[b].defaults[c]={add:!1,search:!1,showLinksOnly:!0,placeholder:"Search",noResults:"No results found."},a[b].addons=a[b].addons||[],a[b].addons.push(c)}(jQuery);