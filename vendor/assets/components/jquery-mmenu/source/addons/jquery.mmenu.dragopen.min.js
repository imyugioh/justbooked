/*	
 * jQuery mmenu dragOpen addon
 * @requires mmenu 4.0.0 or later
 *
 * mmenu.frebsite.nl
 *	
 * Copyright (c) Fred Heusschen
 * www.frebsite.nl
 *
 * Dual licensed under the MIT and GPL licenses.
 * http://en.wikipedia.org/wiki/MIT_License
 * http://en.wikipedia.org/wiki/GNU_General_Public_License
 */


!function(a){function d(a,b,c){return b>a&&(a=b),a>c&&(a=c),a}var b="mmenu",c="dragOpen";a[b].prototype["_addon_"+c]=function(){var e=this,f=this.opts[c];if(a.fn.hammer){var g=a[b]._c,i=(a[b]._d,a[b]._e);g.add("dragging"),i.add("dragleft dragright dragup dragdown dragend");var j=a[b].glbl;if("boolean"==typeof f&&(f={open:f}),"object"!=typeof f&&(f={}),"number"!=typeof f.maxStartPos&&(f.maxStartPos="left"==this.opts.position||"right"==this.opts.position?150:50),f=a.extend(!0,{},a[b].defaults[c],f),f.open){var k=0,l=!1,m=0,n=0,o="width";switch(this.opts.position){case"left":case"right":o="width";break;default:o="height"}switch(this.opts.position){case"left":var p={events:i.dragleft+" "+i.dragright,open_dir:"right",close_dir:"left",delta:"deltaX",page:"pageX",negative:!1};break;case"right":var p={events:i.dragleft+" "+i.dragright,open_dir:"left",close_dir:"right",delta:"deltaX",page:"pageX",negative:!0};break;case"top":var p={events:i.dragup+" "+i.dragdown,open_dir:"down",close_dir:"up",delta:"deltaY",page:"pageY",negative:!1};break;case"bottom":var p={events:i.dragup+" "+i.dragdown,open_dir:"up",close_dir:"down",delta:"deltaY",page:"pageY",negative:!0}}$dragNode=this.__valueOrFn(f.pageNode,this.$menu,j.$page),"string"==typeof $dragNode&&($dragNode=a($dragNode)),$dragNode.hammer().on(i.touchstart,function(a){switch(e.opts.position){case"right":case"bottom":a[p.page]>=j.$wndw[o]()-f.maxStartPos&&(k=1);break;default:a[p.page]<=f.maxStartPos&&(k=1)}}).on(p.events+" "+i.dragend,function(a){k>0&&(a.gesture.preventDefault(),a.stopPropagation())}).on(p.events,function(a){var b=p.negative?-a.gesture[p.delta]:a.gesture[p.delta];if(l=b>m?p.open_dir:p.close_dir,m=b,m>f.threshold&&1==k){if(j.$html.hasClass(g.opened))return;k=2,e._openSetup(),j.$html.addClass(g.dragging),n=d(j.$wndw[o]()*e.conf[c][o].perc,e.conf[c][o].min,e.conf[c][o].max)}if(2==k){var h=j.$page;switch(e.opts.zposition){case"front":h=e.$menu;break;case"next":h=h.add(e.$menu)}h.css(e.opts.position,d(m,10,n))}}).on(i.dragend,function(){if(2==k){var b=j.$page;switch(e.opts.zposition){case"front":b=e.$menu;break;case"next":b=b.add(e.$menu)}j.$html.removeClass(g.dragging),b.css(e.opts.position,""),l==p.open_dir?e._openFinish():e.close()}k=0})}}},a[b].defaults[c]={open:!1,threshold:50},a[b].configuration[c]={width:{perc:.8,min:140,max:440},height:{perc:.8,min:140,max:880}},a[b].addons=a[b].addons||[],a[b].addons.push(c)}(jQuery);